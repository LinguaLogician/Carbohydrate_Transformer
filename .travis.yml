dist: xenial
language: python
python:
  - "3.5"
git:
  depth: false
addons:
  apt:
    packages:
      # Additional dependencies for im2text and speech2text
      - libsox-dev
      - libsox-fmt-all
      - sox
before_install:
  # Install CPU version of PyTorch.
  - if [[ $TRAVIS_PYTHON_VERSION == 3.5 ]]; then pip install torch==1.2.0 -f https://download.pytorch.org/whl/cpu/torch_stable.html; fi
  - pip install -r requirements.opt.txt
  - python setup.py install   

jobs:
  include:
    - name: "Flake8 Lint Check"
      env: LINT_CHECK
      install: pip install flake8 pep8-naming==0.7.0
      script: flake8

deploy:
  provider: pypi
  server: https://${PYPI_SERVER}
  distributions: "sdist bdist_wheel"
  username: ${PYPI_USERNAME}
  password: ${PYPI_PASSWORD}
  on:
    tags: true

